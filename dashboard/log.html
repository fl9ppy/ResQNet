<!DOCTYPE html>
<html>
<head>
  <title>Event Log – Crisis Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <header>
    <h1>Event Log</h1>
  </header>

  <div class="container">
    <section>
      <h2>Alert History</h2>
      <button onclick="loadLog()">Reload Log</button>
      <pre id="log-output" class="log-box"></pre>
    </section>
  </div>

<script>
function loadLog() {
  fetch("http://" + window.location.hostname + ":8081/log")
    .then(r => r.text())
    .then(text => {
      const output = document.getElementById("log-output");
      if (!text.trim()) {
        output.textContent = "No logs recorded.";
        return;
      }

      const lines = text.trim().split("\n");
      output.innerHTML = "";

      lines.forEach(line => {
        const event = JSON.parse(line);
        const div = document.createElement("div");
        div.classList.add("log-entry");

        div.innerHTML = `
          <strong>${event.timestamp}</strong><br>
          <span class="log-type">${event.event}</span> – ${event.message}<br>
          MQ3: ${event.mq3} | TEMP: ${event.temp}<br>
          Dist(G): ${event.dist_mq3} | Dist(T): ${event.dist_temp}
          <hr>
        `;

        output.appendChild(div);
      });
    });
}

loadLog();
</script>

</body>
</html>